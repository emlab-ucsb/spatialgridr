<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Get gridded or cropped data from input data"><title>Get gridded or cropped data from input data — get_data_in_grid • spatialgridr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get gridded or cropped data from input data — get_data_in_grid"><meta property="og:description" content="Get gridded or cropped data from input data"><meta property="og:image" content="https://emlab-ucsb.github.io/spatialgridr/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">spatialgridr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get gridded or cropped data from input data</h1>
      
      <div class="d-none name"><code>get_data_in_grid.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Get gridded or cropped data from input data</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_data_in_grid</span><span class="op">(</span></span>
<span>  boundary <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spatial_grid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dat <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  meth <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  feature_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  antimeridian <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cutoff <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  apply_cutoff <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>boundary</dt>
<dd><p><code>sf</code> object with boundary of the area(s) you want gridded data for, e.g an EEZ or country. Boundaries can be obtained using <code><a href="get_boundary.html">get_boundary()</a></code></p></dd>


<dt>spatial_grid</dt>
<dd><p><code>sf</code> or <code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast()</a></code> grid created using <code><a href="get_grid.html">get_grid()</a></code></p></dd>


<dt>dat</dt>
<dd><p><code>sf</code> or <code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast()</a></code> data to be gridded/ cropped</p></dd>


<dt>meth</dt>
<dd><p><code>character</code> method to use for for gridding/ resampling/ reprojecting raster data. If NULL (default), function checks if data values are binary (all 0, 1, NA, or NaN) in which case method is set to "mode" for sf output or "near" for raster output. If data is non-binary, method is set to "average" for sf output or "mean" for raster output. Note that different methods are used for sf and raster as <code><a href="https://isciences.gitlab.io/exactextractr/reference/exact_extract.html" class="external-link">exactextractr::exact_extract()</a></code> is used for gridding to sf spatial grid, whereas <code><a href="https://rspatial.github.io/terra/reference/project.html" class="external-link">terra::project()</a></code>/<code><a href="https://rspatial.github.io/terra/reference/resample.html" class="external-link">terra::resample()</a></code> is used for transforming/ gridding raster data.</p></dd>


<dt>name</dt>
<dd><p><code>character</code> to name the data output; unless <code>feature_names</code> is supplied, in which case that column is used as the feature names</p></dd>


<dt>feature_names</dt>
<dd><p><code>character</code> (<code>sf</code> data only) column with feature names that will be used for grouping of input data. If NULL, <code>sf</code> data is assumed to represent a single features, e.g. one habitat or species.</p></dd>


<dt>antimeridian</dt>
<dd><p><code>logical</code> can be set to true if the <code>boundary</code> or <code>spatial_grid</code> for which data will be extracted crosses the antimeridian and the data source is in lon-lat (EPSG:4326) format. If set to <code>NULL</code> (default) the function will try to check if the antimeridian is crossed and set this appropriately. Note that if you are using an <code>boundary</code> or <code>spatial_grid</code> that crosses the antimeridian and have data that is not in lon-lat</p></dd>


<dt>cutoff</dt>
<dd><p><code>numeric</code> (<code>sf</code> data only) cover fraction value between 0 and 1; if gridded output is required (i.e. a <code>spatial_grid</code> is provided), how much of each grid cell should be covered by an sf feature for it to be classified as that feature type</p></dd>


<dt>apply_cutoff</dt>
<dd><p><code>logical</code> (<code>sf</code> data only) if gridded output is required (i.e. a <code>spatial_grid</code> is provided), <code>FALSE</code> will return an <code>sf</code> object with the % coverage of each feature in each grid cell, as opposed to a binary presence/ absence. <code>feature_names</code> should be provided.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>sf</code> or <code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast()</a></code> object; cropped and intersected data in same format as <code>dat</code> if  an <code>boundary</code> is provided, otherwise <code>sf</code> or <code><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">terra::rast()</a></code> gridded data depending on the format of the spatial grid provided</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># ridges data for area of Pacific</span></span></span>
<span class="r-in"><span><span class="va">ridges</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ridges.rds"</span>, package <span class="op">=</span> <span class="st">"spatialgridr"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># use get_boundary() to get Samoa's Exclusive Economic Zone</span></span></span>
<span class="r-in"><span><span class="va">samoa_eez</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_boundary.html">get_boundary</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Samoa"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You need a suitable projection for your area of interest, https://projectionwizard.org is useful for this purpose. If you are doing spatial planning, equal area projections are normally best.</span></span></span>
<span class="r-in"><span><span class="va">samoa_projection</span> <span class="op">&lt;-</span> <span class="st">'+proj=laea +lon_0=-172.5 +lat_0=0 +datum=WGS84 +units=m +no_defs'</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a spatial grid with 5km square cells</span></span></span>
<span class="r-in"><span><span class="va">samoa_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_grid.html">get_grid</a></span><span class="op">(</span>boundary <span class="op">=</span> <span class="va">samoa_eez</span>, projection_crs <span class="op">=</span> <span class="va">samoa_projection</span>, resolution <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Get ridges data, which is vector data in sf format, in the spatial grid</span></span></span>
<span class="r-in"><span><span class="va">ridges_gridded</span> <span class="op">&lt;-</span> <span class="fu">get_data_in_grid</span><span class="op">(</span>spatial_grid <span class="op">=</span> <span class="va">samoa_grid</span>, dat <span class="op">=</span> <span class="va">ridges</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>attribute variables are assumed to be spatially constant throughout all geometries</span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ridges_gridded</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_data_in_grid-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Get some raster data on cold water corals for the same spatial grid</span></span></span>
<span class="r-in"><span><span class="va">cold_coral</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"cold_coral.tif"</span>, package <span class="op">=</span> <span class="st">"spatialgridr"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/rast.html" class="external-link">rast</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coral_gridded</span> <span class="op">&lt;-</span> <span class="fu">get_data_in_grid</span><span class="op">(</span>spatial_grid <span class="op">=</span> <span class="va">samoa_grid</span>, dat <span class="op">=</span> <span class="va">cold_coral</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">coral_gridded</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="get_data_in_grid-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jason Flower.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

